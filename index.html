<html>
	<head>
		<title>Slothmachine Game Engine 0.666</title>
		<script src="src/util/math.js"></script>
		<script src="src/transform.js"></script>

		<script src="src/camera.js"></script>
		<script src="src/renderer/canvas.js"></script>
		<script src="src/renderer/shader.js"></script>
		<script src="src/renderer/texture.js"></script>
		<script src="src/entity.js"></script>
		<script src="src/input/input.js"></script>
		<script src="src/slothmachine.js"></script>

		<script id="default-vertex" type="x-shader/x-vertex">
			attribute vec3 a_position;
			attribute vec3 a_normal;
			attribute vec2 a_texCoords;

			//uniform vec2 u_resolution;

			uniform mat4 u_model;
			uniform mat4 u_view;
			uniform mat4 u_projection;

			varying highp vec2 v_texCoords;

			void main()
			{
				vec4 pos = u_model * u_view * u_projection * vec4(a_position, 1.0);
				
				gl_Position = pos;

				v_texCoords = a_texCoords.st;
			}
		</script>
		<script id="default-fragment" type="x-shader/x-fragment">
			precision mediump float;

			varying highp vec2 v_texCoords;
			uniform sampler2D u_texture;

			void main()
			{
				vec2 tc = vec2(v_texCoords.s, 1.0 - v_texCoords.t);
				vec4 color = texture2D(u_texture, tc);
				gl_FragColor = color;
			}
		</script>

	</head>
	<body>
		<canvas id="game" width="800" height="600"></canvas>
		<script type="text/javascript">
		    var fps = 60;
			var game = new SlothMachine("game");

			//init the engine and it's components
			game.init();

			//create shaders and shit so we can draw stuff on screen and see if it works
			var gl = game.renderer.context;

			var spaceship = new Entity();
			spaceship.shader = new Shader(gl, "default");

		 
			spaceship.init(gl);
			spaceship.texture = new Texture(spaceship, gl, "mfgrid.png");
			spaceship.render = true;

			//spaceship.position.x = 400;
			//spaceship.position.y = 300;

			spaceship.scale.xyz = 0.1;
		 
			game.camera.position.z = -5;

			var ticks = 0;
			game.player = spaceship;

			//start the game
			function gameLoop(){

				game.update();

				spaceship.rotation.x += 0.1;
				spaceship.rotation.y += 0.1;

				spaceship.update();
				spaceship.draw(gl);

				ticks++;

				setTimeout(function() {
					gameLoop();
				}, fps / 1000);
			};

			gameLoop();

		</script>
	</body>
</html>
