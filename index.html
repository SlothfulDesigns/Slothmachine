<html>
	<head>
		<title>Slothmachine Game Engine 0.666</title>
		<script src="src/slothmachine.js"></script>
		<script src="src/util/math.js"></script>
		<script src="src/transform.js"></script>
		<script src="src/renderer/canvas.js"></script>
		<script src="src/renderer/shader.js"></script>
		<script src="src/entity.js"></script>

		<script id="default-vertex" type="x-shader/x-vertex">
			attribute vec2 Position;

			uniform vec2 u_resolution;
			uniform mat3 u_translation;

			void main()
			{
				vec2 pos = (u_translation * vec3(Position, 1.0)).xy;
				//gl_Position = vec4(pos, 0.0, 1.0);
				gl_Position = vec4(Position, 0.0, 1.0);
			}
		</script>
		<script id="default-fragment" type="x-shader/x-fragment">
			precision mediump float;

			void main()
			{
				gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
			}
		</script>

	</head>
	<body>
		<canvas id="game" width="800" height="600"></canvas>
		<script type="text/javascript">
		    var fps = 60;
			var game = new SlothMachine("game");

			//init the engine and it's components
			game.init();

			//create shaders and shit so we can draw stuff on screen and see if it works
			var gl = game.renderer.context;

			var spaceship = new Entity();
			spaceship.mesh = new Float32Array(
				[0.0, 0.0,
				 0.1, 0.1,
				 0.2, 0.0]);
			spaceship.shader = new Shader(gl, "default");
			spaceship.init(gl);
			spaceship.render = true;
			spaceship.position.x = 5; //game.renderer.canvas.clientWidth / 2;
			spaceship.position.y = 5; //game.renderer.canvas.clientHeight / 2;

			var ticks = 0;

			//start the game
			function gameLoop(){

				game.update();

				//spaceship.position.x += Math.sin(ticks);
				spaceship.update();
				spaceship.draw(gl);

				ticks++;

				setTimeout(function() {
					gameLoop();
				}, fps / 1000);
			};

			gameLoop();

		</script>
	</body>
</html>
